# Main zshrc - Keep this minimal and fast
# Source: https://github.com/ohmyzsh/ohmyzsh

# Amazon Q pre block. Keep at the top of this file.
[[ -f "${HOME}/Library/Application Support/amazon-q/shell/zshrc.pre.zsh" ]] && builtin source "${HOME}/Library/Application Support/amazon-q/shell/zshrc.pre.zsh" 

# Oh-My-Zsh configuration
export ZSH="$HOME/.oh-my-zsh"
ZSH_THEME="robbyrussell"

# Plugins - Your original configuration
plugins=(1password aliases alias-finder ansible brew chezmoi colored-man-pages colorize command-not-found common-aliases direnv docker docker-compose fzf gatsby gcloud gh git-auto-fetch gnu-utils golang history istioctl jira kubectl kubectx macos nvm opentofu pre-commit python sigstore skaffold ssh sudo terraform thefuck themes tldr vscode zoxide)

# Load Oh-My-Zsh
source $ZSH/oh-my-zsh.sh

# Load modular configuration
ZSH_CONFIG_DIR="$HOME/.config/zsh"

# Core configuration (always loaded)
[[ -f "$ZSH_CONFIG_DIR/core.zsh" ]] && source "$ZSH_CONFIG_DIR/core.zsh"

# Environment variables
[[ -f "$ZSH_CONFIG_DIR/env.zsh" ]] && source "$ZSH_CONFIG_DIR/env.zsh"

# Aliases
[[ -f "$ZSH_CONFIG_DIR/aliases.zsh" ]] && source "$ZSH_CONFIG_DIR/aliases.zsh"

# Functions
[[ -f "$ZSH_CONFIG_DIR/functions.zsh" ]] && source "$ZSH_CONFIG_DIR/functions.zsh"

# fzf configuration (heavy, load last)
[[ -f "$ZSH_CONFIG_DIR/fzf.zsh" ]] && source "$ZSH_CONFIG_DIR/fzf.zsh"

# Platform-specific configuration
{{ if eq .chezmoi.os "darwin" }}
# macOS-specific Homebrew
eval "$(/opt/homebrew/bin/brew shellenv)"
{{ else if eq .chezmoi.os "linux" }}
# Linux-specific Homebrew
eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
{{ end }}

# Platform-specific configuration files (if needed)
{{ if eq .chezmoi.os "darwin" }}
# macOS-specific configuration
[[ -f "$ZSH_CONFIG_DIR/macos.zsh" ]] && source "$ZSH_CONFIG_DIR/macos.zsh"
{{ else if eq .chezmoi.os "linux" }}
# Linux-specific configuration
[[ -f "$ZSH_CONFIG_DIR/linux.zsh" ]] && source "$ZSH_CONFIG_DIR/linux.zsh"
{{ end }}
